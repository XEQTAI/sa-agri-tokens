<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">

    <!-- iOS-specific meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SA Agri Exchange">
    <meta name="theme-color" content="#10b981">

    <title>Exchange - SA Agri Tokens</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="exchange.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Stellar SDK from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stellar-sdk/11.2.2/stellar-sdk.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <span class="logo-icon">üåæ</span>
                    <span class="logo-text">SA Agri Tokens</span>
                </div>
                <div class="nav-menu" id="navMenu">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="index.html#about" class="nav-link">About</a>
                    <a href="index.html#tokens" class="nav-link">Tokens</a>
                    <a href="exchange.html" class="nav-link">Exchange</a>
                    <a href="index.html#contact" class="nav-link">Contact</a>
                </div>
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Exchange Section -->
    <section class="exchange-section">
        <div class="container">
            <div class="exchange-header">
                <h1>ü™ô Token Exchange</h1>
                <p>Trade South African agricultural commodity tokens on Stellar Testnet</p>
            </div>

            <!-- Wallet Connection -->
            <div class="wallet-section">
                <div class="wallet-card">
                    <div class="wallet-icon">üëõ</div>
                    <h3>Connect Your Wallet</h3>
                    <p>Connect Freighter wallet to start trading SA Agri Tokens</p>
                    <button class="btn btn-primary btn-large" id="connectWallet">
                        <span id="walletStatus">Connect Wallet</span>
                    </button>
                    <div class="wallet-info" id="walletInfo" style="display: none;">
                        <p><strong>Connected:</strong> <span id="walletAddress">-</span></p>
                        <p class="wallet-hint">üåê Network: Testnet</p>
                    </div>
                </div>
            </div>

            <!-- Token Markets -->
            <div class="markets-header">
                <h2>üåæ Available Markets</h2>
                <p>Live agricultural commodity tokens</p>
            </div>

            <div class="markets-grid">
                <!-- MAIZE Token -->
                <div class="market-card" data-token="MAIZE">
                    <div class="market-header">
                        <div class="market-info">
                            <span class="market-icon">üåΩ</span>
                            <div>
                                <h3>MAIZE/XLM</h3>
                                <p>White Maize Token</p>
                                <small class="token-issuer" title="GCRX44F63XLA4NDO7H6L7JAWAJYW4GP63CHGNOQM4QY4NFIMVZC542WY">GCRX44F6...</small>
                            </div>
                        </div>
                        <div class="market-price">
                            <div class="price">1.00 XLM</div>
                            <div class="change positive">+0.0%</div>
                        </div>
                    </div>
                    <div class="market-stats">
                        <div class="stat">
                            <span class="stat-label">Your Balance</span>
                            <span class="stat-value" data-asset="MAIZE">
                                <span class="balance-amount">0.0000</span> MAIZE
                            </span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Total Supply</span>
                            <span class="stat-value">10,000</span>
                        </div>
                    </div>
                    <div class="market-actions">
                        <button class="btn btn-primary btn-trade" onclick="openTradeModal('MAIZE', 'buy')" disabled>
                            üõí Buy MAIZE
                        </button>
                        <button class="btn btn-secondary btn-trade" onclick="openTradeModal('MAIZE', 'sell')" disabled>
                            üí∞ Sell MAIZE
                        </button>
                        <button class="btn btn-outline" onclick="addTrustline('MAIZE')" disabled>
                            ‚ûï Add Trustline
                        </button>
                    </div>
                </div>

                <!-- WHEAT Token -->
                <div class="market-card" data-token="WHEAT">
                    <div class="market-header">
                        <div class="market-info">
                            <span class="market-icon">üåæ</span>
                            <div>
                                <h3>WHEAT/XLM</h3>
                                <p>Milling Wheat Token</p>
                                <small class="token-issuer" title="GCGPWVIIRAZNPJNV5LEOMULOTN6PXYW767K6VYTUTSX3UO5S7TC2FVC7">GCGPWVII...</small>
                            </div>
                        </div>
                        <div class="market-price">
                            <div class="price">1.00 XLM</div>
                            <div class="change positive">+0.0%</div>
                        </div>
                    </div>
                    <div class="market-stats">
                        <div class="stat">
                            <span class="stat-label">Your Balance</span>
                            <span class="stat-value" data-asset="WHEAT">
                                <span class="balance-amount">0.0000</span> WHEAT
                            </span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Total Supply</span>
                            <span class="stat-value">10,000</span>
                        </div>
                    </div>
                    <div class="market-actions">
                        <button class="btn btn-primary btn-trade" onclick="openTradeModal('WHEAT', 'buy')" disabled>
                            üõí Buy WHEAT
                        </button>
                        <button class="btn btn-secondary btn-trade" onclick="openTradeModal('WHEAT', 'sell')" disabled>
                            üí∞ Sell WHEAT
                        </button>
                        <button class="btn btn-outline" onclick="addTrustline('WHEAT')" disabled>
                            ‚ûï Add Trustline
                        </button>
                    </div>
                </div>

                <!-- SOYSA Token -->
                <div class="market-card" data-token="SOYSA">
                    <div class="market-header">
                        <div class="market-info">
                            <span class="market-icon">ü´ò</span>
                            <div>
                                <h3>SOYSA/XLM</h3>
                                <p>Soybean Token</p>
                                <small class="token-issuer" title="GCBM5SBKZQUMHIFY4BU7DBIUNHYYZP5ACRQBGBECJX2DKTN5R5EJBAM3">GCBM5SBK...</small>
                            </div>
                        </div>
                        <div class="market-price">
                            <div class="price">1.00 XLM</div>
                            <div class="change positive">+0.0%</div>
                        </div>
                    </div>
                    <div class="market-stats">
                        <div class="stat">
                            <span class="stat-label">Your Balance</span>
                            <span class="stat-value" data-asset="SOYSA">
                                <span class="balance-amount">0.0000</span> SOYSA
                            </span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Total Supply</span>
                            <span class="stat-value">10,000</span>
                        </div>
                    </div>
                    <div class="market-actions">
                        <button class="btn btn-primary btn-trade" onclick="openTradeModal('SOYSA', 'buy')" disabled>
                            üõí Buy SOYSA
                        </button>
                        <button class="btn btn-secondary btn-trade" onclick="openTradeModal('SOYSA', 'sell')" disabled>
                            üí∞ Sell SOYSA
                        </button>
                        <button class="btn btn-outline" onclick="addTrustline('SOYSA')" disabled>
                            ‚ûï Add Trustline
                        </button>
                    </div>
                </div>
            </div>

            <!-- Info Banner -->
            <div class="info-banner">
                <div class="info-content">
                    <h3>üöÄ Live Trading on Stellar Testnet!</h3>
                    <p>
                        <strong>Your tokens are LIVE!</strong> Connect your Freighter wallet to start trading. 
                        Currently on <strong>Testnet</strong> for safe testing. Get free testnet XLM from 
                        <a href="https://laboratory.stellar.org/#account-creator?network=test" target="_blank" rel="noopener">Stellar Laboratory</a>.
                    </p>
                    <p style="margin-top: 12px;">
                        <strong>New to Freighter?</strong> Install from 
                        <a href="https://www.freighter.app/" target="_blank" rel="noopener">freighter.app</a> and 
                        switch to <strong>Testnet</strong> in settings.
                    </p>
                </div>
            </div>

            <!-- How to Trade -->
            <div class="trade-guide">
                <h2>üìñ How to Trade</h2>
                <div class="guide-steps">
                    <div class="guide-step">
                        <div class="guide-number">1</div>
                        <div class="guide-step-content">
                            <h4>Install Freighter</h4>
                            <p>Get the <a href="https://www.freighter.app/" target="_blank" rel="noopener">Freighter wallet</a> 
                            browser extension and create/import your Stellar account.</p>
                        </div>
                    </div>
                    <div class="guide-step">
                        <div class="guide-number">2</div>
                        <div class="guide-step-content">
                            <h4>Get Testnet XLM</h4>
                            <p>Visit <a href="https://laboratory.stellar.org/#account-creator?network=test" target="_blank" rel="noopener">
                            Stellar Laboratory</a> to fund your testnet account with free XLM.</p>
                        </div>
                    </div>
                    <div class="guide-step">
                        <div class="guide-number">3</div>
                        <div class="guide-step-content">
                            <h4>Connect & Trade</h4>
                            <p>Connect your wallet above, add trustlines for tokens, then buy/sell agricultural tokens!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="logo">
                        <span class="logo-icon">üåæ</span>
                        <span class="logo-text">SA Agri Tokens</span>
                    </div>
                    <p>Bringing blockchain innovation to South African agriculture.</p>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <a href="index.html#about">About Us</a>
                    <a href="index.html#tokens">Tokens</a>
                    <a href="TOKENS_README.md" target="_blank">Token Docs</a>
                </div>
                <div class="footer-section">
                    <h4>Network</h4>
                    <a href="https://stellar.org" target="_blank" rel="noopener">Stellar Network</a>
                    <a href="https://laboratory.stellar.org" target="_blank" rel="noopener">Stellar Lab</a>
                    <a href="https://stellar.expert/explorer/testnet" target="_blank" rel="noopener">Explorer</a>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <p>Email: info@saagritokens.com</p>
                    <p>South Africa üáøüá¶</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 SA Agri Tokens. Built on Stellar Network.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="exchange.js"></script>
</body>
</html>